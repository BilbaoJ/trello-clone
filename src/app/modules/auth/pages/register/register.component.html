<main class="w-screen h-screen bg-white relative">
  <app-background></app-background>
  <section class="relative w-10/12 md:w-5/12 lg:w-3/12 m-auto">
    <app-header></app-header>
    <div class="pb-4 px-6">
      <div class="mb-4">
        <h1 class="text-center font-semibold pt-4 pb-4 text-gray-800">
          Regístrate para continuar
        </h1>
        @if (!showRegister()) {
          <form [formGroup]="formUser" novalidate class="space-y-4" (ngSubmit)="validateUser()">
            <div>
              <div class="relative">
                <input
                  formControlName="email"
                  placeholder="Ingrese correo electrónico"
                  type="text"
                  class="w-full rounded border-2 border-gray-300 text-sm"
                />
              </div>
              @if (formUser.controls.email.touched && formUser.controls.email.invalid) {
                <div>
                  @if (formUser.controls.email.hasError('required')) {
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Este campo es obligatorio
                    </p>
                  } @else if (formUser.controls.email.hasError('email')){
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Ingrese un correo valido
                    </p>
                  }
                </div>
              }
            </div>
            <div>
              <app-btn typeBtn="submit" color="primary">Continuar</app-btn>
            </div>
          </form>
        } @else {
          <form [formGroup]="form" novalidate class="space-y-4" (ngSubmit)="register()">
            <div>
              <div class="relative">
                <input
                  formControlName="email"
                  placeholder="Ingrese correo electrónico"
                  type="text"
                  class="w-full rounded border-2 border-gray-300 text-sm"
                />
              </div>
              @if (form.controls.email.touched && form.controls.email.invalid) {
                <div>
                  @if (form.controls.email.hasError('required')) {
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Este campo es obligatorio
                    </p>
                  } @else if (form.controls.email.hasError('email')){
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Ingrese un correo valido
                    </p>
                  }
                </div>
              }
            </div>
            <div>
              <div class="relative">
                <input
                  formControlName="name"
                  placeholder="Ingrese su nombre"
                  type="text"
                  class="w-full rounded border-2 border-gray-300 text-sm"
                />
              </div>
              @if (form.controls.name.touched && form.controls.name.invalid) {
                <div>
                  @if (form.controls.name.hasError('required')) {
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Este campo es obligatorio
                    </p>
                  }
                </div>
              }
            </div>
            <div>
              <div class="relative">
                <input
                  formControlName="password"
                  placeholder="Ingrese su contraseña"
                  [type]="showPassword() ? 'text' : 'password'"
                  class="w-full rounded border-2 border-gray-300 text-sm"
                />
                <button class="absolute right-2 p-2" type="button" (click)="showPassword.set(!showPassword())">
                  <fa-icon [icon]="showPassword() ? faEye : faEyeSlash"></fa-icon>
                </button>
              </div>
              @if (form.controls.password.touched && form.controls.password.invalid) {
                <div>
                  @if (form.controls.password.hasError('required')) {
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Este campo es obligatorio
                    </p>
                  } @else if (form.controls.password.hasError('minlength')){
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      La contraseña debe ser de 8 caracteres minimo
                    </p>
                  }
                </div>
              }
            </div>
            <div>
              <div class="relative">
                <input
                  formControlName="confirmPassword"
                  placeholder="Confirma la contraseña"
                  type="password"
                  class="w-full rounded border-2 border-gray-300 text-sm"
                />
              </div>
              @if (form.controls.confirmPassword.touched && form.controls.confirmPassword.invalid) {
                <div>
                  @if (form.controls.confirmPassword.hasError('required')) {
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      Este campo es obligatorio
                    </p>
                  } @else if (form.controls.confirmPassword.hasError('minlength')){
                    <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                      La contraseña debe ser de 8 caracteres minimo
                    </p>
                  }
                </div>
              }
            </div>
            @if (form.controls.confirmPassword.touched) {
              <div>
                @if (form.hasError('mismatch')) {
                  <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                    Las contraseñas no coinciden
                  </p>
                }
              </div>
            }
            @if (status() === 'failed' && message() !== '') {
              <p class="font-medium text-red-500 text-xs mt-1 ml-1">
                {{ message() }}
              </p>
            }
            <div>
              <app-btn typeBtn="submit" color="primary">Registrarse</app-btn>
            </div>
          </form>
        }
      </div>
      <div>
        <ul class="flex space-x-2 justify-center text-center">
          <li>
            <a routerLink="/login" class="text-sm text-blue-600 hover:underline">¿Ya tienes una cuenta Atlassian? Inicia sesión</a>
          </li>
        </ul>
      </div>
    </div>
    <app-footer></app-footer>
  </section>
</main>
